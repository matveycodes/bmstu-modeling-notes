\section{Лекция №8 (30.10.2023)}

\subsection{Немарковские случайные процессы, сводящиеся к марковским}

Известно, что реальные процессы обладают последействием и поэтому не являются марковскими. Иногда при исследовании таких процессов удается воспользоваться методами, разработанными для марковских цепей. К ним относят:

\begin{itemize}
    \item метод разложения случайного процесса на фазы (метод псевдосостояний);
    \item метод вложенных цепей Маркова.
\end{itemize}

\subsubsection{Метод псевдосостояний}

Сущность метода состоит в том, что состояния системы, потоки переходов из которых являются немарковскими, заменяются эквивалентной группой фиктивных состояний, потоки из которых уже являются марковскими.

Условия статистической эквивалентности выбираются по-разному. За счет расширения числа состояний в системе некоторые процессы удается точно свести к марковским. Созданная таким образом новая система статистически эквивалентна или близка к реальной системе.

К числу процессов, которые введением фиктивных состояний можно точно свести к марковским, относятся процессы, происходящие под воздействием потоков Эрланга. В случае потока Эрланга $k$-ого порядка интервал времени между соседними событиями представляет собой сумму $k$ независимых случайных интервалов, распределенных по показательному закону.

Сведение потока Эрланга $k$-ого порядка к пуассоновскому осуществляется введением $k$ псевдосостояний. Интенсивность перехода между состояниями равна соответствующему параметру потока Эрланга. Полученный таким образом случайный процесс (он эквивалентен исходному) является марковским, так как интервалы времени нахождения его в различных состояниях подчиняются показательному закону.

Некоторые устройства выходят из строя с интенсивностью $\lambda$. Поток отказов --- пуассоновский. После отказа устройство восстанавливается. Время восстановления распределено по закону Эрланга 3-го порядка. Найти предельные вероятности возможных состояний системы.

Система может принимать два возможных состояния:

\begin{itemize}
    \item $S_0$ --- устройство исправно;
    \item $S_1$ --- устройство отказало и восстанавливается.
\end{itemize}

Переход из $S_0$ в $S_1$ --- пуассоновский закон, наоборот --- эрланговский. Время восстановления можно представить в виде суммы трех времен, они распределены по показательному закону и имеют интенсивность $\mu$.

\image
{.5\textwidth}
{08/inc/states}
{}

Для установившегося состояния составляем уравнения Колмогорова.
%
\begin{gather*}
    \begin{cases}
        p_0' = 0 = -\lambda p_0+\mu p_{13}    \\
        p_{11}' = 0 = -\mu p_{11}+\lambda p_0 \\
        p_{12}' = 0 = -\mu p_{12}+\mu p_{11}  \\
        p_{13}' = 0 = -\mu p_{13}+\mu p_{12}  \\
        p_0 + p_1 = 1                         \\
        p_1 = p_{11} + p_{12} + p_{13}
    \end{cases}
\end{gather*}
%
Решаем полученную систему.
%
\begin{gather*}
    p_{13} = \dfrac{\lambda}{\mu}p_0,\ p_{11} = \dfrac{\lambda}{\mu}p_0\\
    p_{12} = p_{11} = \dfrac{\lambda}{\mu}p_0\\
    p_1 = \dfrac{3\lambda}{\mu}p_0\\
    p_0 + \dfrac{3\lambda}{\mu}p_0 = 1\Rightarrow p_0 = \dfrac{\mu}{\mu + 3\lambda}\\
    p_1 = \dfrac{3\lambda}{\mu + 3\lambda}
\end{gather*}

\subsection{Лабораторная работа №3}

Необходимо взять одно-, двух- и трехразрядные числа, сгенерированные табличным и алгоритмическим способами (три столбца). Дать возможность ввести 10 любых чисел и затем под каждым из столбцов вывести число, показывающее случайность данной последовательности --- разработать количественный критерий случайности для чисел, сгенерированных табличным и алгоритмическим способами. Если числа будут подчиняться какому-либо закону, то они уже не случайны.

См. Кнут II том и Деон А. Ф.

\subsubsection{Метод вложенных цепей Маркова}

Вложенные марковские цепи образуются следующим образом. В исходном случайном процессе выбираются такие случайные процессы, в которых процесс является марковским. Эти моменты времени обычно являются случайными и зависят от свойств исходного процесса.

Частным случаем данного метода является полумарковский случайный процесс. Случайный процесс с конечным (счетным) множеством состояний называется \textit{полумарковским}, если заданы вероятности перехода системы из состояния в состояние и распределение времени пребывания процесса в каждом состоянии в виде функции распределения или функции плотности распределения.

\subsection{Алгоритмы генерации последовательности псевдослучайных чисел}

Одним из первых способов получения последовательности псевдослучайных чисел было выделение значения дробной части у многочлена первой степени:
%
\begin{gather*}
    y_n = \text{Ent}(an+b)
\end{gather*}
%
Здесь $n\in\mathbb{N}$. Якоби доказал, что при рациональном коэффициенте $a$ множество $y_n$ конечно, а при иррациональном --- бесконечно и всюду плотно на интервале от 0 до 1.

Среднее по реализациям псевдослучайных чисел равно среднему по всему их множеству с вероятностью 1.

\subsubsection{Фон Нейман}

Каждое последующее случайное число образуется возведением предыдущего в квадрат и отбрасывании цифр с обоих концов.

\subsubsection{Лемер}
%
\begin{gather*}
    g_{n+1} = kg_n + c\text{ mod }m
\end{gather*}
%
<...>

Принято решение, что работать нужно с целыми числами. При ${c = 0}$ и ${m = 2^n}$ наибольший период достигается при ${k = 3+8i}$ или ${k=5+8i}$ и нечетном начальном числе.

В 1977 г. Форсайд показал, что тройки последовательности чисел лежат всего на 15
параллельных плоскостях.

От отчаяния используют два или даже три различных генератора, смешивая их значения. Если разные генераторы независимы, то сумма их последовательностей обладает дисперсией, равной сумме дисперсий. В современных системах обычно используют конгруэнтные генераторы по алгоритму, предложенному национальным бюро стандартов США, длина периода которого --- $2^{24}$.

\subsubsection{Целочисленная арифметика}

Берем бесконечный ряд Фибоначчи и, если брать только последнюю цифру каждого числа и использовать понятие бита переноса, то получается случайное число.

Для имитации равномерного распределения на интервале от $a$ до $b$ используется обратное преобразование функции плотности:
%
\begin{gather*}
    \dfrac{x-a}{b-a} = R\\
    x = a + (b-a)R
\end{gather*}
%
Здесь $R$ изменяется от 0 до 1.

В основе построения программы, генерирующей случайные числа с законом распределения, отличным от равномерного, лежит метод преобразования последовательности случайных чисел с равномерным законом распределения в последовательность с заданным.
%
\begin{gather*}
    F(t) = \int\limits_{-\infty}^{t} f(x)dx = R
\end{gather*}
%
Метод основан на утверждении, что случайная величина $x$, принимающая значения, равные корню уравнения выше, имеет плотность распределения $f(x)$. $R$ --- равномерно распределенная случайная величина на интервале от 0 до 1.

Значение случайной величины, распределенной по показательному закону, может быть вычислено следующим образом:
%
\begin{gather*}
    1 - e^{-\lambda x} = R\\
    x = -\dfrac{1}{\lambda}\ln(1-R)
\end{gather*}
%
Распределение Пуассона относится к дискретному с мат. ожиданием и дисперсией, равной ${\lambda > 0}$. Для генерирования пуассоновских переменных используется метод точек, в основе которого лежит генерирование случайной переменной $R_i$, равномерно распределенной на [0, 1], до тех пор, пока не будет выполнено следующее соотношение.
%
\begin{gather*}
    \prod\limits_{i=0}^{x}R_i\geqslant e^{-\lambda} > \prod\limits_{i=0}^{x+1}R_i
\end{gather*}
%
При получении случайной величины, функция распределения которой не позволяет найти решение уравнения в явной форме, можно произвести кусочно-линейную аппроксимацию, а затем вычислять приближенное значение корня. Кроме того, при получении случайных величин часто используют те или иные свойства распределения.

Распределение Эрланга определяется параметрами $\lambda$ и $k$. При вычислении случайной величины воспользуемся тем, что поток Эрланга может быть получен прореживанием потока Пуассона $k$ раз. Поэтому достаточно получить $k$ значений случайной величины, распределенной по показательному закону, и усреднить их:
%
\begin{gather*}
    x = \dfrac{1}{k}\sum\limits_{i=1}^{k}\left(-\dfrac{1}{\lambda}\ln(1-R_i)\right) = -\dfrac{1}{k\lambda} \sum\limits_{i=1}^{k}\ln(1-R_i)
\end{gather*}
%
Нормально распределенная случайная величина может быть получена как сумма большого числа случайных величин, распределенных по одному и тому же закону и с одними и теми же параметрами:
%
\begin{gather*}
    x = \sigma_x\sqrt{\dfrac{12}{n}}\left(\sum\limits_{i=1}^n R_i - \dfrac{n}{2}\right) + M_x
\end{gather*}
%
На практике берут ${n = 12}$.